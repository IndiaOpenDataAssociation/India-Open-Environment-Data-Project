/*
 * Orange angular-swagger-ui - v0.3.1
 *
 * (C) 2015 Orange, all right reserved
 * MIT Licensed
 */
"use strict";angular.module("swaggerUi").service("swaggerUiExternalReferences",["$http","$q","swaggerModules","swaggerTranslator",function(a,b,c,d){function e(a){l.reject(a)}function f(b,f,g){var h={method:"GET",url:b,transformResponse:function(a){g&&(a=a.replace(/"\$ref": ?"#\/(.*)\/(.*)"/g,'"$ref": "#/$1/'+g+'/$2"'));var b;try{b=angular.fromJson(a)}catch(c){e({code:500,message:d.translate("errorJsonParse")})}return b}};c.execute(c.BEFORE_LOAD,h).then(function(){a(h).success(f).error(function(a,b){e({message:a,code:b})})})["catch"](e)}function g(a){var b=a.split("#/"),c=b[0];if(0!==c.indexOf("http")&&0!==c.indexOf("https"))if(0===c.indexOf("/")){var d=URL.parse(k);c=d.protocol+"//"+d.host+c}else{var e=k.lastIndexOf("/");c=k.substring(0,e)+"/"+c}return c}function h(){function a(a){b++,f(g(a.$ref),function(c){b--,delete a.$ref;for(var d in c)a[d]=c[d];0===b&&j()})}var b=0;for(var c in m.paths){var d=m.paths[c];i(d)&&a(d)}0===b&&j()}function i(a){return a&&a.$ref&&0!==a.$ref.indexOf("#/")}function j(){function a(a){var b=a.$ref.match(/(.*)#\/(.*)\/(.*)/),c=b[1],h=b[2],i=g(a.$ref);a.$ref=a.$ref.replace(/(.*)#\/(.*)\/(.*)/,"#/$2/$1/$3"),e[i]||(d++,e[i]=!0,f(i,function(a){for(var b in a)m[h][c]=a[b];d--,0===d&&l.resolve(!0)},c))}function b(b){i(b)?a(b):i(b.items)&&a(b.items)}function c(a){for(var c=0,d=a.parameters||[],e=d.length;e>c;c++)d[c].schema&&b(d[c].schema);for(var f in a.responses||{})a.responses[f].schema&&b(a.responses[f].schema)}var d=0,e={};for(var h in m.paths){var j=m.paths[h];for(var k in j)c(j[k])}0===d&&l.resolve(!0)}var k,l,m;this.execute=function(a,c){return k=a,m=c,l=b.defer(),h(),l.promise}}]).run(["swaggerModules","swaggerUiExternalReferences",function(a,b){a.add(a.BEFORE_PARSE,b)}]);